# YouTube字幕電子書製作器

將YouTube影片的硬編碼字幕截圖並組合成可翻頁閱讀的電子書格式。

## 功能特色

- ✅ 自動截取影片字幕區域
- ✅ 組合成多行字幕的頁面
- ✅ 全螢幕閱讀模式
- ✅ 翻頁時同步播放對應音訊
- ✅ 可調整截圖間隔和每頁行數
- ✨ **新功能：預覽設定效果** - 在製作前先預覽一個頁面的截圖

## 安裝方式

### 1. 下載原始碼
將此資料夾下載到本機

### 2. 建立圖示檔案
在專案目錄中建立三個圖示檔案（或使用任何PNG圖片）：
- `icon16.png` (16x16)
- `icon48.png` (48x48)
- `icon128.png` (128x128)

可以暫時使用任何圖片，或執行以下命令產生簡單的圖示：

```bash
# 使用ImageMagick建立簡單圖示（如果有安裝）
convert -size 16x16 xc:red icon16.png
convert -size 48x48 xc:red icon48.png
convert -size 128x128 xc:red icon128.png
```

### 3. 載入擴充功能

1. 開啟Chrome瀏覽器
2. 進入 `chrome://extensions/`
3. 開啟右上角的「開發人員模式」
4. 點擊「載入未封裝項目」
5. 選擇此專案資料夾：`youtube-subtitle-book`
6. 完成！

## 使用方式

### 步驟1: 開啟YouTube影片
前往任何有硬編碼字幕的YouTube影片頁面

### 步驟2: 設定參數
點擊瀏覽器工具列的擴充功能圖示，設定：
- **截圖間隔**：每隔幾秒截取一次字幕（建議2-3秒）
- **每頁顯示行數**：一頁要顯示幾行字幕（建議5-7行）
- **字幕區域高度**：字幕佔影片高度的百分比（建議15%）

### 步驟2.5: 預覽設定（推薦） ✨
在開始製作前，建議先預覽設定效果：
1. 將影片暫停在有字幕的位置
2. 點擊「🔍 預覽設定效果」按鈕
3. 查看預覽視窗中的截圖效果
4. 如果字幕位置不正確，調整參數後再次預覽
5. 確認滿意後，點擊「確定」關閉預覽

詳細說明請參考：[PREVIEW_FEATURE.md](PREVIEW_FEATURE.md)

### 步驟3: 開始製作
點擊「開始製作電子書」按鈕

程式會自動：
1. 暫停影片
2. 每隔N秒跳轉並截取字幕區域
3. 將截圖組合成頁面
4. 顯示進度

### 步驟4: 閱讀模式
製作完成後，點擊「開啟閱讀器」

閱讀器功能：
- **全螢幕顯示**：黑色背景，專注閱讀
- **多行字幕**：一次看到多行連續字幕
- **翻頁瀏覽**：使用上一頁/下一頁按鈕
- **音訊同步**：點擊播放按鈕會播放該頁對應的影片音訊

## 技術原理

### 截圖機制
```javascript
// 使用Canvas API截取影片的字幕區域
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');

// 只截取影片下方15%的區域（字幕通常在此）
ctx.drawImage(video,
  0, subtitleY, videoWidth, subtitleHeight,
  0, 0, canvas.width, canvas.height
);

const screenshot = canvas.toDataURL('image/png');
```

### 頁面組合
將連續的N張截圖組合成一頁，例如：
```
第1頁 = 截圖1(0秒) + 截圖2(2秒) + 截圖3(4秒) + 截圖4(6秒) + 截圖5(8秒)
第2頁 = 截圖6(10秒) + 截圖7(12秒) + ...
```

### 音訊同步
```javascript
// 播放某一頁的音訊
video.currentTime = page.startTime;  // 跳到該頁開始時間
video.play();                         // 播放

// 到達結束時間時暫停
if (video.currentTime >= page.endTime) {
  video.pause();
}
```

## 注意事項

### 限制
1. **硬編碼字幕限定**：此工具針對影片中嵌入的字幕，不適用於YouTube CC字幕
2. **截圖數量**：長影片會產生大量截圖，佔用記憶體
3. **手動調整**：需要手動調整字幕區域高度參數以適應不同影片

### 效能建議
- 短影片（<10分鐘）：建議截圖間隔1-2秒
- 中等影片（10-30分鐘）：建議截圖間隔2-3秒
- 長影片（>30分鐘）：建議截圖間隔3-5秒

### 儲存空間
截圖以Base64格式儲存在Chrome的local storage中：
- 每張PNG截圖約50-100KB
- 10分鐘影片（間隔2秒）= 約300張 = 15-30MB

## 進階功能（未來開發）

- [ ] 匯出成PDF
- [ ] 字幕去重（跳過相同內容）
- [ ] 智慧分頁（根據字幕變化）
- [ ] 書籤功能
- [ ] 閱讀進度記憶
- [ ] 音訊片段下載

## 疑難排解

### Q: 截圖全黑或沒有內容？
A: 調整「字幕區域高度」參數，某些影片字幕位置可能不同

### Q: 製作速度很慢？
A: 正常現象，因為需要逐一跳轉並等待畫面載入。長影片需要較長時間

### Q: 按「開啟閱讀器」沒反應？
A: 確認已完成製作（進度100%），並重新整理YouTube頁面後再試

### Q: 關閉閱讀器後資料會消失嗎？
A: 資料儲存在瀏覽器中，除非清除擴充功能資料，否則會保留

## 開發者資訊

### 專案結構
```
youtube-subtitle-book/
├── manifest.json      # 擴充功能設定
├── popup.html         # 控制面板UI
├── popup.js           # 控制面板邏輯
├── content.js         # 核心功能（截圖、組合、閱讀器）
├── content.css        # 閱讀器樣式
└── icon*.png          # 圖示檔案
```

### 除錯方式
1. 開啟YouTube影片頁面
2. 按F12開啟開發者工具
3. 切換到Console標籤
4. 查看錯誤訊息

## 授權
MIT License
