# YouTube字幕電子書製作器

將YouTube影片的硬編碼字幕截圖並組合成可翻頁閱讀的電子書格式。

## 功能特色

- ✅ **自動截取**：自動截取影片字幕區域
- ✅ **頁面組合**：組合成多行字幕的頁面
- ✅ **全螢幕閱讀**：沉浸式閱讀體驗
- ✅ **音訊同步**：翻頁時同步播放對應音訊
- ✅ **完整編輯功能**：
  - 插入/複製截圖（新增功能 ✨）
  - 調整時間戳記
  - 新增上方字幕
  - 刪除截圖
- ✅ **播放控制**：
  - 靜音/取消靜音
  - 多段倍速控制 (1x, 1.25x, 1.5x, 2x)
- ✅ **即時預覽**：在製作前預覽設定效果
- ✅ **雙視窗模式**：支援一邊截圖一邊閱讀/編輯

## 安裝方式

### 1. 下載原始碼
將此資料夾下載到本機

### 2. 建立圖示檔案
在專案目錄中建立三個圖示檔案（或使用任何PNG圖片）：
- `icon16.png` (16x16)
- `icon48.png` (48x48)
- `icon128.png` (128x128)

可以暫時使用任何圖片，或執行以下命令產生簡單的圖示：

```bash
# 使用ImageMagick建立簡單圖示（如果有安裝）
convert -size 16x16 xc:red icon16.png
convert -size 48x48 xc:red icon48.png
convert -size 128x128 xc:red icon128.png
```

### 3. 載入擴充功能

1. 開啟Chrome瀏覽器
2. 進入 `chrome://extensions/`
3. 開啟右上角的「開發人員模式」
4. 點擊「載入未封裝項目」
5. 選擇此專案資料夾：`youtube-subtitle-book`
6. 完成！

## 使用方式

### 步驟1: 開啟YouTube影片
前往任何有硬編碼字幕的YouTube影片頁面

### 步驟2: 設定參數
點擊瀏覽器工具列的擴充功能圖示，設定：
- **截圖間隔**：每隔幾秒截取一次字幕（建議2-3秒）
- **每頁顯示行數**：一頁要顯示幾行字幕（建議5-7行）
- **字幕區域高度**：字幕佔影片高度的百分比（建議15%）

### 步驟2.5: 預覽設定（推薦） ✨
在開始製作前，建議先預覽設定效果：
1. 將影片暫停在有字幕的位置
2. 點擊「🔍 預覽設定效果」按鈕
3. 查看預覽視窗中的截圖效果
4. 如果字幕位置不正確，調整參數後再次預覽
5. 確認滿意後，點擊「確定」關閉預覽

詳細說明請參考：[PREVIEW_FEATURE.md](PREVIEW_FEATURE.md)

### 步驟3: 開始製作
點擊「開始製作電子書」按鈕

程式會自動：
1. 自動靜音並加速影片（加快製作速度）
2. 每隔N秒跳轉並截取字幕區域
3. 將截圖組合成頁面
4. 顯示進度

### 步驟4: 閱讀與編輯
製作完成後，點擊「開啟閱讀器」。新版支援**雙視窗模式**，閱讀器會在獨立的新分頁開啟，不會干擾原本的截圖視窗。

**閱讀器功能：**
- **全螢幕顯示**：黑色背景，專注閱讀
- **播放控制**：
  - 🔇 **靜音控制**：可隨時切換靜音狀態
  - ⚡ **倍速播放**：支援 1.25x, 1.5x, 2x 播放速度
- **編輯功能**：
  - ➕ **插入截圖**：點擊「向下插入」複製當前截圖並編輯
  - 📝 **新增上方字幕**：為截圖添加上方註解或翻譯
  - ⏱️ **調整時間**：微調每張截圖的開始/結束時間
  - 🗑️ **刪除**：刪除不需要的截圖或頁面
- **即時保存**：所有的編輯都會自動儲存到瀏覽器中

## 技術原理

### 雙視窗架構 (Dual-Tab Architecture)
為了支援同時截圖與編輯，系統採用雙視窗設計：
1. **Capture Tab (影片頁)**：負責控制影片跳轉、截取畫面。
2. **Reader Tab (閱讀器)**：獨立運作於新分頁，負責顯示內容、接收使用者編輯操作。
兩者透過 `chrome.storage` 進行資料同步與持久化。

### 截圖機制
```javascript
// 使用Canvas API截取影片的字幕區域
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');

// 只截取影片下方15%的區域（字幕通常在此）
ctx.drawImage(video,
  0, subtitleY, videoWidth, subtitleHeight,
  0, 0, canvas.width, canvas.height
);

const screenshot = canvas.toDataURL('image/png');
```

## 注意事項

### 限制
1. **硬編碼字幕限定**：此工具針對影片中嵌入的字幕，不適用於YouTube CC字幕
2. **截圖數量**：長影片會產生大量截圖，佔用記憶體
3. **手動調整**：需要手動調整字幕區域高度參數以適應不同影片

### 效能建議
- 短影片（<10分鐘）：建議截圖間隔1-2秒
- 中等影片（10-30分鐘）：建議截圖間隔2-3秒
- 長影片（>30分鐘）：建議截圖間隔3-5秒

### 儲存空間
截圖以Base64格式儲存在Chrome的local storage中：
- 每張PNG截圖約50-100KB
- 10分鐘影片（間隔2秒）= 約300張 = 15-30MB

## 進階功能（未來開發）

- [ ] 匯出成PDF
- [ ] 字幕去重（跳過相同內容）
- [ ] 智慧分頁（根據字幕變化）
- [ ] 書籤功能
- [ ] 閱讀進度記憶
- [ ] 音訊片段下載

## 疑難排解

### Q: 截圖全黑或沒有內容？
A: 調整「字幕區域高度」參數，某些影片字幕位置可能不同

### Q: 製作速度很慢？
A: 正常現象，因為需要逐一跳轉並等待畫面載入。程式會自動加速播放以縮短時間。

### Q: 編輯後的內容會消失嗎？
A: 不會。新版採用即時儲存機制，您的編輯（插入、刪除、時間調整）都會保留在瀏覽器儲存空間中。

## 開發者資訊

### 專案結構
```
youtube-subtitle-book/
├── manifest.json      # 擴充功能設定
├── popup.html         # 控制面板UI
├── popup.js           # 控制面板邏輯
├── content.js         # 核心功能（截圖、組合）
├── reader.js          # 閱讀器邏輯 (獨立分頁)
├── reader.html        # 閱讀器介面 (獨立分頁)
├── content.css        # 樣式表
└── icon*.png          # 圖示檔案
```

## 授權
MIT License
